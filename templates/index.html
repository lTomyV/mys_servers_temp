<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulación de Servidores - Análisis Monte Carlo</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Chart.js para gráficos interactivos -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- Chart.js annotation plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation"></script>
    <!-- Chart.js zoom plugin -->
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom"></script>
    <!-- heatmap.js para mapa de calor -->
    <script src="https://cdn.jsdelivr.net/npm/heatmap.js@2.0.5/build/heatmap.min.js"></script>
</head>
<body>
    <header>
        <h1>Simulación de Servidores - Análisis Monte Carlo</h1>
        <p class="subtitle">Optimización de consumo energético en centros de datos</p>
    </header>

    <main>
        <section class="intro-section">
            <h2>Simulación Física de Servidores</h2>
            <p>Esta aplicación simula el comportamiento térmico y el consumo energético de una sala de servidores utilizando un modelo físico detallado y análisis Monte Carlo para evaluar diferentes estrategias de control.</p>
            
            <div class="simulation-controls">
                <div class="control-group">
                    <label for="modelo-refrigeracion">Modelo de Refrigeración:</label>
                    <select id="modelo-refrigeracion">
                        <!-- Opciones predeterminadas en caso de que la carga dinámica falle -->
                        <option value="economico">Económico (Estándar)</option>
                        <option value="eficiente" selected>Eficiente (Inverter)</option>
                        <option value="premium">Premium (VRF)</option>
                    </select>
                    <div class="model-tooltip">
                        <span class="tooltip-icon">?</span>
                        <div class="tooltip-content">
                            <p>Seleccione el modelo de equipo de refrigeración a utilizar en la simulación:</p>
                            <ul>
                                <li><strong>Económico:</strong> Menor costo inicial pero menor eficiencia energética</li>
                                <li><strong>Eficiente:</strong> Balance entre costo y eficiencia</li>
                                <li><strong>Premium:</strong> Mayor costo inicial pero máxima eficiencia energética</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <button id="simulate-button">Simular</button>
            </div>
            
            <div id="simulation-status" class="status-message"></div>
            <div id="simulation-progress"></div>
        </section>

        <section id="results-section" class="results-section">
            <h2>Resultados de la Simulación</h2>
            
            <div id="modelo-info" class="modelo-info-panel">
                <!-- Información del modelo de refrigeración seleccionado -->
            </div>
            
            <div id="cost-stats" class="stats-panel">
                <!-- Estadísticas de costo -->
            </div>
            
            <div class="results-grid">
                <div class="result-card">
                    <h3>Curvas COP de Refrigeración</h3>
                    <div class="chart-container">
                        <canvas id="cop-curves-chart"></canvas>
                        <button class="expand-chart-btn" data-chart-canvas="cop-curves-chart">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <div class="explanation-trigger" data-target="cop-curves-explanation">
                            <span class="info-icon">i</span>
                        </div>
                        <div id="cop-curves-explanation" class="explanation-text">
                            {{ explanations.cop_curves }}
                        </div>
                    </div>
                </div>
                
                <div class="result-card">
                    <h3>Diagnóstico de Randomización</h3>
                    <div class="chart-container">
                        <canvas id="randomization-chart"></canvas>
                        <button class="expand-chart-btn" data-chart-canvas="randomization-chart">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <div class="explanation-trigger" data-target="randomization-explanation">
                            <span class="info-icon">i</span>
                        </div>
                        <div id="randomization-explanation" class="explanation-text">
                            {{ explanations.randomization }}
                        </div>
                    </div>
                </div>
                
                <div class="result-card">
                    <h3>Distribución de Temperaturas Horarias</h3>
                    <div class="chart-container">
                        <canvas id="hourly-temp-chart"></canvas>
                        <button class="expand-chart-btn" data-chart-canvas="hourly-temp-chart">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <div class="explanation-trigger" data-target="temperature-distribution-explanation">
                            <span class="info-icon">i</span>
                        </div>
                        <div id="temperature-distribution-explanation" class="explanation-text">
                            {{ explanations.temperature_distribution }}
                        </div>
                    </div>
                </div>
                
                <div class="result-card">
                    <h3>Histograma de Costos</h3>
                    <div class="chart-container">
                        <canvas id="cost-histogram"></canvas>
                        <button class="expand-chart-btn" data-chart-canvas="cost-histogram">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <div class="explanation-trigger" data-target="cost-monthly-explanation">
                            <span class="info-icon">i</span>
                        </div>
                        <div id="cost-monthly-explanation" class="explanation-text">
                            {{ explanations.cost_monthly }}
                        </div>
                    </div>
                </div>

                <div class="result-card">
                    <h3>Histograma de Costo Servidores</h3>
                    <div class="chart-container">
                        <canvas id="server-cost-histogram"></canvas>
                        <button class="expand-chart-btn" data-chart-canvas="server-cost-histogram">
                            <i class="fas fa-expand-arrows-alt"></i>
                        </button>
                        <div class="explanation-trigger" data-target="cost-server-explanation">
                            <span class="info-icon">i</span>
                        </div>
                        <div id="cost-server-explanation" class="explanation-text">
                            Costo mensual de la energía consumida exclusivamente por los servidores.
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="simulation-time" class="simulation-time"></div>
        </section>
        
        <section class="technical-section">
            <h2>Detalles Técnicos del Modelo</h2>
            
            <div class="tech-details">
                <div class="tech-card">
                    <h3>Modelo Físico</h3>
                    <p>El modelo físico implementa ecuaciones diferenciales que representan la dinámica térmica de una sala de servidores:</p>
                    <div class="equation">
                        <p>dT/dt = (Q<sub>servers</sub> + Q<sub>transmission</sub> - Q<sub>cooling</sub>) / C<sub>th</sub></p>
                    </div>
                    <p>Donde:</p>
                    <ul>
                        <li>T: Temperatura de la sala [K]</li>
                        <li>Q<sub>servers</sub>: Calor generado por los servidores [W]</li>
                        <li>Q<sub>transmission</sub>: Calor transmitido desde el exterior [W]</li>
                        <li>Q<sub>cooling</sub>: Potencia de refrigeración [W]</li>
                        <li>C<sub>th</sub>: Capacidad térmica de la sala [J/K]</li>
                    </ul>
                </div>
                
                <div class="tech-card">
                    <h3>Modelo de Consumo Energético</h3>
                    <p>El consumo eléctrico del sistema de refrigeración se calcula como:</p>
                    <div class="equation">
                        <p>P<sub>electric</sub> = Q<sub>cooling</sub> / COP</p>
                    </div>
                    <p>Donde el COP (Coefficient of Performance) depende de la temperatura exterior y del modelo de refrigeración seleccionado.</p>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2025 Simulación de Servidores - Análisis Monte Carlo</p>
    </footer>

    <!-- Modal para gráficos expandidos -->
    <div id="chart-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <div class="modal-chart-container">
                <canvas id="modal-chart"></canvas>
            </div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/scripts_new.js') }}"></script>
</body>
</html> 